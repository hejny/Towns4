<?php//----------------------------------------------------------------------------------------------------------------------Name,Textif(isset($GLOBALS['get']['id'])){    $id=intval($GLOBALS['get']["id"]);    list($ai_name,$res)=sql_row("SELECT name,res,x,y FROM [mpx]pos_obj WHERE id=".$id." AND `own`=".$GLOBALS['ss']['logid']." AND type='ai' AND ".objt());    $res = explode(':',$res,2);    $ai_text=$res[1];}else{    $ai_name=trim($_POST['ai_name']);    $ai_text=trim($_POST['ai_text']);}//----------------------------------------------------------------------------------------------------------------------IDif(!$id){    if ($_POST['ai_id']) {        $id = intval($_POST['ai_id']);    } else {        $id = nextid();    }}//----------------------------------------------------------------------------------------------------------------------Textif($ai_text){    //Uprava, kontrola}//----------------------------------------------------------------------------------------------------------------------Window Titleif($id or $_POST['ai_send']){    window(lr('title_ai_edit'));}else{    window(lr('title_ai_create'));}contenu_a();//----------------------------------------------------------------------------------------------------------------------Savingif($_POST['ai_send']){    //----------------------------------------------------Errors    if(!trim($ai_name)){        error(lr('ai_error_noname'));    }elseif(!trim($ai_text)){        error(lr('ai_error_notext'));    }else {        if (ifobject($id,true)) {            //----------------------------------------------------UPDATE            trackobject($id);            //------------------UPDATE objects            sql_update('objects', "id='$id'", array(                'id' => $id,                'name' => $ai_name,                'type' => 'ai',                'userid' => '',                'origin' => '',                'fp' => '',                'func' => '',                'hold' => '',                'res' => 'html:' . $ai_text,//@todo Takhle?                'profile' => '',                'set' => '',                'own' => $GLOBALS['ss']['logid'],//@todo Takhle?                't' => '',                'pt' => ''            ),3);            //------------------UPDATE positions            sql_update('positions', "id='$id'", array(                'id' => $id,                'ww' => $GLOBALS['ss']["ww"],                'x' => $x,                'y' => $y,                'traceid' => '',                'starttime' => time(),                'readytime' => 0,                'stoptime' => 0            ));            //----------------------------------------------------        } else {            //----------------------------------------------------INSERT NEW            //------------------INSERT objects            sql_insert('objects', array(                'id' => $id,                'name' => $ai_name,                'type' => 'ai',                'userid' => '',                'origin' => '',                'fp' => '',                'func' => '',                'hold' => '',                'res' => 'html:' . $ai_text,//@todo Takhle?                'profile' => '',                'set' => '',                'own' => $GLOBALS['ss']['logid'],//@todo Takhle?                't' => '',                'pt' => ''            ),3);            //------------------INSERT positions            sql_insert('positions', array(                'id' => $id,                'ww' => $GLOBALS['ss']["ww"],                'x' => $x,                'y' => $y,                'traceid' => '',                'starttime' => time(),                'readytime' => 0,                'stoptime' => 0            ));            //----------------------------------------------------        }        $tmpobject=new object($id);        $tmpobject->update(true);        unset($tmpobject);        //centerurl()        click('e=map;noi=1;');    }}//----------------------------------------------------------------------------------------------------------------------Formform_a('','ai_form');$style='font-size:22px;width: 100%;border: 2px solid #171717; background-color: #222;color:#fff;';input_hidden('ai_send',1);input_hidden('ai_id',$id?$id:0);input_text('ai_name',$ai_name,200,'',$style,lr('ai_name'));input_textarea('ai_text',$ai_text,15,0,$style,'ai_write_placeholder');/*?>  <textarea id="ai_text" name="text" style="width:800;height:200px;"><?=htmlspecialchars($ai_text)?></textarea><?php*/form_send(lr('ai_send'),'font-size:18px;width:100%;color: #cccccc;border: 2px solid #555555; background-color: rgba(40,20,40,1);');form_b();form_js('content','?e=ai-create',array('ai_name','ai_text','ai_send','ai_id'));e(rand(1,99));?></form><?phpcontenu_b();?>